{% if field.value is not empty %}
    <div class="customer-orders-detail">
        {% set orders = field.value %}
        {% set orderCount = orders|length %}
        {% set totalSpent = 0 %}
        
        {% for order in orders %}
            {% set totalSpent = totalSpent + order.totalAmount %}
        {% endfor %}
        
        <div class="orders-summary mb-3">
            <span class="badge badge-info me-2">{{ orderCount }} orders</span>
            <span class="badge badge-success">${{ "%.2f"|format(totalSpent) }} total spent</span>
        </div>
        
        {% if orderCount > 0 %}
            <div class="orders-list">
                <h6>Recent Orders:</h6>
                <div class="table-responsive">
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>Order #</th>
                                <th>Status</th>
                                <th>Total</th>
                                <th>Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for order in orders|slice(0, 10) %}
                                <tr>
                                    <td>
                                        <a href="{{ ea_url().setController('App\\Controller\\Admin\\OrderCrudController').setAction('detail').setEntityId(order.id) }}" 
                                           class="text-decoration-none">
                                            {{ order.orderNumber }}
                                        </a>
                                    </td>
                                    <td>
                                        {% if order.status == 'pending' %}
                                            <span class="badge badge-warning">Pending</span>
                                        {% elseif order.status == 'processing' %}
                                            <span class="badge badge-info">Processing</span>
                                        {% elseif order.status == 'shipped' %}
                                            <span class="badge badge-primary">Shipped</span>
                                        {% elseif order.status == 'delivered' %}
                                            <span class="badge badge-success">Delivered</span>
                                        {% elseif order.status == 'cancelled' %}
                                            <span class="badge badge-danger">Cancelled</span>
                                        {% else %}
                                            <span class="badge badge-secondary">{{ order.status|title }}</span>
                                        {% endif %}
                                    </td>
                                    <td>${{ "%.2f"|format(order.totalAmount) }}</td>
                                    <td>{{ order.createdAt|date('Y-m-d H:i') }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                
                {% if orderCount > 10 %}
                    <p class="text-muted"><small>Showing 10 most recent orders out of {{ orderCount }} total.</small></p>
                {% endif %}
            </div>
        {% endif %}
    </div>
{% else %}
    <span class="badge badge-secondary">No orders</span>
{% endif %}